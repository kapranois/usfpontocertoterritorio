<!-- templates/equipe.html -->
{% extends "base.html" %}

{% block title %}{{ nome_equipe }} - Equipe{% endblock %}

{% block extra_css %}
<style>
/* ===== RESET E CONFIGURA√á√ïES GERAIS ===== */
:root {
    --primary: #4f46e5;
    --primary-light: #818cf8;
    --primary-bg: #f8fafc;
    --surface: #ffffff;
    --text: #334155;
    --text-light: #64748b;
    --border: #e2e8f0;
    --shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    --shadow-hover: 0 10px 25px -5px rgba(0, 0, 0, 0.08);
    --radius: 12px;
    --radius-lg: 16px;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--primary-bg);
    color: var(--text);
    line-height: 1.6;
}

/* ===== LAYOUT DA P√ÅGINA ===== */
.equipe-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 24px;
}

/* ===== CABE√áALHO LEVE ===== */
.equipe-header {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 32px;
    margin-bottom: 32px;
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
}

.equipe-header h1 {
    font-size: 28px;
    font-weight: 600;
    color: var(--text);
    margin: 0 0 8px 0;
    display: flex;
    align-items: center;
    gap: 12px;
}

.equipe-header h1 i {
    color: var(--primary);
    font-size: 24px;
}

.equipe-header > p {
    color: var(--text-light);
    margin: 0;
    font-size: 15px;
}

/* ===== ESTAT√çSTICAS MINIMALISTAS ===== */
.equipe-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 20px;
    margin-top: 32px;
}

.equipe-stat {
    text-align: center;
    padding: 20px;
    background: var(--primary-bg);
    border-radius: var(--radius);
    border: 1px solid var(--border);
}

.equipe-stat .number {
    display: block;
    font-size: 28px;
    font-weight: 600;
    color: var(--primary);
    line-height: 1;
    margin-bottom: 4px;
}

.equipe-stat .label {
    font-size: 14px;
    color: var(--text-light);
    font-weight: 500;
}

/* ===== GRID DE PROFISSIONAIS MODERNO ===== */
.equipe-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
    gap: 24px;
    margin-bottom: 40px;
}

/* ===== CARDS LIMPOS ===== */
.equipe-card {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 0;
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
    transition: all 0.25s ease;
    overflow: hidden;
}

.equipe-card:hover {
    box-shadow: var(--shadow-hover);
    transform: translateY(-2px);
}

/* Cabe√ßalho do Card */
.card-header {
    padding: 24px 24px 16px;
    border-bottom: 1px solid var(--border);
    background: var(--primary-bg);
    display: flex;
    align-items: flex-start;
    gap: 16px;
}

.card-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    flex-shrink: 0;
}

.card-icon.acs { background: #e0f2fe; color: #0369a1; }
.card-icon.enfermeiro { background: #f0f9ff; color: #0c4a6e; }
.card-icon.medico { background: #f5f3ff; color: #5b21b6; }

.card-title h3 {
    margin: 0 0 4px 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text);
}

.card-title .subtitle {
    color: var(--text-light);
    font-size: 14px;
    margin: 0;
}

/* ===== LISTA DE PROFISSIONAIS ===== */
.profissionais-lista {
    padding: 20px 24px;
}

.profissional-item {
    display: flex;
    align-items: center;
    padding: 16px;
    border-radius: 10px;
    margin-bottom: 12px;
    border: 1px solid var(--border);
    transition: all 0.2s ease;
}

.profissional-item:hover {
    background: var(--primary-bg);
    border-color: var(--primary-light);
}

.profissional-avatar {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    background: var(--primary);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 14px;
    font-size: 16px;
    flex-shrink: 0;
}

.profissional-info h4 {
    margin: 0 0 4px 0;
    font-size: 15px;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
}

.profissional-info p {
    margin: 0;
    color: var(--text-light);
    font-size: 13px;
    display: flex;
    align-items: center;
    gap: 6px;
}

.badge {
    display: inline-block;
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    line-height: 1;
}

.badge:not(.inativo) {
    background: #10b981;
    color: white;
}

.badge.inativo {
    background: #94a3b8;
    color: white;
}

/* ===== PROFISSIONAL DESTAQUE (Vers√£o Minimalista) ===== */
.profissional-destaque {
    padding: 24px;
    text-align: center;
    background: var(--primary-bg);
    border-radius: var(--radius);
    border: 1px solid var(--border);
}

.destaque-avatar {
    width: 64px;
    height: 64px;
    border-radius: 16px;
    background: var(--primary);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 16px;
    font-size: 24px;
}

.profissional-destaque h4 {
    margin: 0 0 8px 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text);
}

.profissional-destaque p {
    margin: 6px 0;
    color: var(--text-light);
    font-size: 14px;
}

/* ===== ESTADO VAZIO ELEGANTE ===== */
.empty-state {
    padding: 40px 20px;
    text-align: center;
    color: var(--text-light);
}

.empty-state i {
    font-size: 40px;
    margin-bottom: 16px;
    color: #cbd5e1;
    opacity: 0.6;
}

.empty-state p {
    margin: 0 0 20px 0;
    font-size: 15px;
}

/* ===== BOT√ïES MODERNOS ===== */
.card-actions {
    padding: 20px 24px;
    border-top: 1px solid var(--border);
    background: var(--primary-bg);
    display: flex;
    justify-content: flex-end;
}

.btn-action {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 10px 18px;
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-action:hover {
    background: #4338ca;
    transform: translateY(-1px);
}

.btn-action.secondary {
    background: transparent;
    color: var(--primary);
    border: 1px solid var(--primary);
}

.btn-action.secondary:hover {
    background: var(--primary);
    color: white;
}

/* ===== BOT√ÉO DE VOLTA DISCRETO ===== */
.back-button {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
    font-size: 15px;
    margin-bottom: 24px;
    padding: 10px 16px;
    border-radius: 8px;
    transition: all 0.2s ease;
}

.back-button:hover {
    background: var(--primary-bg);
    text-decoration: none;
}

/* ===== RESPONSIVIDADE ===== */
@media (max-width: 768px) {
    .equipe-container {
        padding: 16px;
    }

    .equipe-header {
        padding: 24px;
        margin-bottom: 24px;
    }

    .equipe-stats {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
    }

    .equipe-grid {
        grid-template-columns: 1fr;
        gap: 20px;
    }

    .card-header {
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 12px;
    }

    .profissional-item {
        flex-direction: column;
        text-align: center;
        padding: 20px;
    }

    .profissional-avatar {
        margin-right: 0;
        margin-bottom: 12px;
    }

    .profissional-info h4 {
        justify-content: center;
        flex-wrap: wrap;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="equipe-container">
    <!-- Cabe√ßalho Leve -->
    <div class="equipe-header">
        <h1><i class="fas fa-users-medical"></i> Equipe {{ nome_equipe }}</h1>
        <p>Equipe multiprofissional de sa√∫de da fam√≠lia</p>

        <div class="equipe-stats">
            <div class="equipe-stat">
                <span class="number">
                    {% if equipe_profissionais %}
                    {% set total = 0 %}
                    {% if equipe_profissionais.get('acs') %}{% set total = total + equipe_profissionais.get('acs')|length %}{% endif %}
                    {% if equipe_profissionais.get('enfermeiro') %}{% set total = total + 1 %}{% endif %}
                    {% if equipe_profissionais.get('medico') %}{% set total = total + 1 %}{% endif %}
                    {{ total }}
                    {% else %}0{% endif %}
                </span>
                <span class="label">Profissionais</span>
            </div>

            <div class="equipe-stat">
                <span class="number">{{ condominios|length }}</span>
                <span class="label">Condom√≠nios</span>
            </div>

            <div class="equipe-stat">
                <span class="number">{{ metricas.total_moradores }}</span>
                <span class="label">Moradores</span>
            </div>

            <div class="equipe-stat">
                <span class="number">{{ metricas.cobertura_geral|default(0) }}%</span>
                <span class="label">Cobertura</span>
            </div>
        </div>
    </div>

    <!-- Grid de Profissionais Moderno -->
    <div class="equipe-grid">
        <!-- Agentes Comunit√°rios de Sa√∫de -->
        <div class="equipe-card">
            <div class="card-header">
                <div class="card-icon acs">
                    <i class="fas fa-user-md"></i>
                </div>
                <div class="card-title">
                    <h3>Agentes Comunit√°rios de Sa√∫de</h3>
                    <div class="subtitle">Contato direto com a comunidade</div>
                </div>
            </div>

            <div class="profissionais-lista">
                {% if equipe_profissionais and equipe_profissionais.get('acs') %}
                {% for acs in equipe_profissionais.get('acs', []) %}
                <div class="profissional-item">
                    <div class="profissional-avatar">
                        <i class="fas fa-user-md"></i>
                    </div>
                    <div class="profissional-info">
                        <h4>
                            {{ acs.nome }}
                            {% if acs.ativo %}
                            <span class="badge">Ativo</span>
                            {% else %}
                            <span class="badge inativo">Inativo</span>
                            {% endif %}
                        </h4>
                        <p>
                            <i class="fas fa-id-card"></i> {{ acs.registro|default('N/I') }}
                            {% if acs.microarea %}
                            ‚Ä¢ <i class="fas fa-map-marker-alt"></i> {{ acs.microarea }}
                            {% endif %}
                        </p>
                        {% if acs.telefone %}
                        <p><i class="fas fa-phone"></i> {{ acs.telefone }}</p>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <div class="empty-state">
                    <i class="fas fa-user-slash"></i>
                    <p>Nenhum ACS cadastrado</p>
                </div>
                {% endif %}
            </div>

            {% if usuario_logado and nivel_usuario != 'convidado' %}
            <div class="card-actions">
                <button class="btn-action" onclick="dashboard.adicionarACS()">
                    <i class="fas fa-user-plus"></i> Adicionar ACS
                </button>
            </div>
            {% endif %}
        </div>

        <!-- Enfermeiro Respons√°vel -->
        <div class="equipe-card">
            <div class="card-header">
                <div class="card-icon enfermeiro">
                    <i class="fas fa-user-nurse"></i>
                </div>
                <div class="card-title">
                    <h3>Enfermeiro Respons√°vel</h3>
                    <div class="subtitle">Supervis√£o e coordena√ß√£o</div>
                </div>
            </div>

            <div class="profissionais-lista">
                {% if equipe_profissionais and equipe_profissionais.get('enfermeiro') %}
                {% set enfermeiro = equipe_profissionais.get('enfermeiro') %}
                <div class="profissional-destaque">
                    <div class="destaque-avatar">
                        <i class="fas fa-user-nurse"></i>
                    </div>
                    <h4>{{ enfermeiro.nome }}</h4>
                    <p><i class="fas fa-id-card"></i> {{ enfermeiro.registro|default('N/I') }}</p>
                    {% if enfermeiro.especializacao %}
                    <p><i class="fas fa-graduation-cap"></i> {{ enfermeiro.especializacao }}</p>
                    {% endif %}
                    {% if enfermeiro.telefone %}
                    <p><i class="fas fa-phone"></i> {{ enfermeiro.telefone }}</p>
                    {% endif %}
                </div>
                {% else %}
                <div class="empty-state">
                    <i class="fas fa-user-clock"></i>
                    <p>Enfermeiro n√£o designado</p>
                    {% if usuario_logado and nivel_usuario != 'convidado' %}
                    <button class="btn-action" onclick="dashboard.designarEnfermeiro()">
                        <i class="fas fa-user-plus"></i> Designar Enfermeiro
                    </button>
                    {% endif %}
                </div>
                {% endif %}
            </div>

            {% if equipe_profissionais and equipe_profissionais.get('enfermeiro') and usuario_logado and nivel_usuario != 'convidado' %}
            <div class="card-actions">
                <button class="btn-action secondary" onclick="dashboard.mostrarDetalhesEnfermeiro()">
                    <i class="fas fa-eye"></i> Ver detalhes
                </button>
            </div>
            {% endif %}
        </div>

        <!-- M√©dico Respons√°vel -->
        <div class="equipe-card">
            <div class="card-header">
                <div class="card-icon medico">
                    <i class="fas fa-stethoscope"></i>
                </div>
                <div class="card-title">
                    <h3>M√©dico Respons√°vel</h3>
                    <div class="subtitle">Refer√™ncia t√©cnica</div>
                </div>
            </div>

            <div class="profissionais-lista">
                {% if equipe_profissionais and equipe_profissionais.get('medico') %}
                {% set medico = equipe_profissionais.get('medico') %}
                <div class="profissional-destaque">
                    <div class="destaque-avatar">
                        <i class="fas fa-user-md"></i>
                    </div>
                    <h4>{{ medico.nome }}</h4>
                    <p><i class="fas fa-id-card"></i> {{ medico.registro|default('N/I') }}</p>
                    {% if medico.especializacao %}
                    <p><i class="fas fa-heartbeat"></i> {{ medico.especializacao }}</p>
                    {% endif %}
                    {% if medico.telefone %}
                    <p><i class="fas fa-phone"></i> {{ medico.telefone }}</p>
                    {% endif %}
                </div>
                {% else %}
                <div class="empty-state">
                    <i class="fas fa-user-clock"></i>
                    <p>M√©dico n√£o designado</p>
                    {% if usuario_logado and nivel_usuario != 'convidado' %}
                    <button class="btn-action" onclick="dashboard.designarMedico()">
                        <i class="fas fa-user-plus"></i> Designar M√©dico
                    </button>
                    {% endif %}
                </div>
                {% endif %}
            </div>

            {% if equipe_profissionais and equipe_profissionais.get('medico') and usuario_logado and nivel_usuario != 'convidado' %}
            <div class="card-actions">
                <button class="btn-action secondary" onclick="dashboard.mostrarDetalhesMedico()">
                    <i class="fas fa-eye"></i> Ver detalhes
                </button>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        console.log('üìã P√°gina da equipe carregada - Design Leve');
        
        // Melhorar intera√ß√£o dos itens de profissional
        document.querySelectorAll('.profissional-item').forEach(item => {
            item.addEventListener('click', function () {
                // Suavizar o clique
                this.style.transform = 'scale(0.99)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 150);
            });
        });
        
        // Modo convidado - feedback mais amig√°vel
        if (window.APP_CONFIG?.nivel_usuario === 'convidado') {
            document.querySelectorAll('.btn-action').forEach(btn => {
                btn.style.opacity = '0.7';
                btn.style.cursor = 'not-allowed';
                btn.onclick = function (e) {
                    e.preventDefault();
                    alert('üë§ Modo Visitante\n\nEsta a√ß√£o requer autentica√ß√£o. Fa√ßa login para acessar todas as funcionalidades.');
                }
            });
        }
    });
</script>
{% endblock %}
